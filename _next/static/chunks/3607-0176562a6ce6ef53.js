"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3607],{23607:function(e,s,a){a.r(s),a.d(s,{default:function(){return PricingTables}});var l=a(57437),t=a(2265),n=a(56926),i=a(41935),r=a(40210),d=a(37239),o=a(8152),c=a(5925),u=a(63739);let x=["请批准 TCP","锁仓 TCP"];function PositionAdd(e){var s;let{close:a}=e,[m,h]=(0,u.Xs)("parent-address",""),[f,b]=(0,t.useState)(0),[v,p]=(0,t.useState)(0),[w,N]=(0,t.useState)(0),[j,g]=(0,t.useState)(1),[k,y]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),[F,L]=(0,t.useState)(!1),{address:A,isConnecting:P,isDisconnected:T}=(0,n.mA)(),E=(0,n.xx)();(0,n.do)({address:d.lS.address[E],abi:d.lS.abi,functionName:"allowance",args:[A,d.wA.address[E]],chainId:E,watch:!0,onSuccess(e){e&&N(Number((0,i.dF)(null==e?void 0:e.toString()))),console.log("allowanceResult",e),0==f&&e&&Number((0,i.dF)(null==e?void 0:e.toString()))>=1e8&&b(1)}});let{data:B,isSuccess:M,write:z}=(0,n.GG)({address:d.lS.address[E],abi:d.lS.abi,functionName:"approve",onError(e){c.default.error(e.details)}});(0,n.BX)({hash:null==B?void 0:B.hash,onSuccess(e){e.blockNumber&&y(!1)}}),(0,t.useEffect)(()=>{console.log("step",f)},[f]),(0,t.useEffect)(()=>{console.log("lockNum",j),console.log("allowance",w),j<w&&L(!1),Number(j)>Number(w)&&1==f&&(L(!0),c.default.custom(e=>(0,l.jsxs)("div",{className:"".concat(e.visible?"animate-enter":"animate-leave"," max-w-md w-full bg-white shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5"),children:[(0,l.jsx)("div",{className:"flex-1 w-0 p-2",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"flex-shrink-0 pt-0.5",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-red-500",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})})}),(0,l.jsx)("div",{className:"ml-3 flex-1",children:(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"你輸入的金額超過授權額度.需要前往增加授權額度嘛?"})})]})}),(0,l.jsx)("div",{className:"flex border-l border-gray-200",children:(0,l.jsx)("button",{onClick:s=>{s.preventDefault(),b(0),c.default.dismiss(e.id),console.log("close")},className:"w-full border border-transparent rounded-none rounded-r-lg p-4 flex items-center justify-center text-sm font-medium text-red-500 hover:text-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:"去授權"})})]}),{position:"bottom-center",duration:5e3}))},[j,w]),(0,n.KQ)({address:A,token:d.lS.address[E],watch:!0,onSuccess(e){p(Number(e.formatted).toFixed(3))}});let G=(0,n.GG)({address:d.wA.address[E],abi:d.wA.abi,functionName:"lock",onError(e){c.default.error(e.details),C(!1),L(!1)}});return(0,n.BX)({hash:null===(s=G.data)||void 0===s?void 0:s.hash,onSuccess(e){e.blockNumber&&(c.default.success("鎖倉成功"),setTimeout(()=>{C(!1),L(!1),a()},3e3))}}),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"",children:(0,l.jsx)("div",{className:"  flex flex-col justify-center",children:(0,l.jsx)("div",{className:"px-5 sm:px-6 py-8",children:(0,l.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6 flex justify-between",children:[(0,l.jsx)("h1",{className:"h4 font-playfair-display text-slate-800",children:x[f]}),(0,l.jsx)("button",{onClick:a,children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-10 h-10",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,l.jsxs)("div",{className:"text-sm space-y-3",children:[(0,l.jsxs)("div",{className:"".concat(0!=f?"text-slate-400":""," flex"),children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"".concat(f<=0?"hidden":""," w-6 h-6 text-green-600"),children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"1、需要透過鏈上 ERC20 一次批准 TCP"]}),(0,l.jsxs)("div",{className:"".concat(1!=f?"text-slate-400":""," flex"),children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"".concat(f<=1?"hidden":""," w-6 h-6 text-green-600"),children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"2、確認將 TCP 鎖倉"]}),(0,l.jsxs)("div",{className:"".concat(1!=f?"hidden":""),children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("label",{className:" text-sm font-medium mb-1",htmlFor:"lockNum",children:["您鎖倉 ",(0,l.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,l.jsxs)("label",{className:" text-sm font-medium mb-1",htmlFor:"lockNum",children:["餘額:",v," ",(0,l.jsx)("span",{className:"text-blue-700",onClick:e=>{e.preventDefault(),g(v)},children:"最大"})]})]}),(0,l.jsx)("input",{id:"lockNum",className:"form-input py-2 w-full",type:"number",value:j,onChange:e=>{e.preventDefault(),e.stopPropagation(),g(e.target.value)},required:!0})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("div",{className:"".concat(0!=f?"hidden":""),children:(0,l.jsx)(o.Z,{isLoading:k,disabled:k,onClick:()=>{y(!0),z({args:[d.wA.address[E],r.Bz],value:(0,i.fi)("0.003")})},children:"允許鎖倉 TCP"})}),(0,l.jsx)("div",{className:"".concat(1!=f?"hidden":""),children:(0,l.jsx)(o.Z,{isLoading:S,disabled:F||S,onClick:()=>{if(j<1){c.default.error("鎖倉數量太低");return}if(!m){c.default.error("請使用邀請連結打開");return}C(!0),G.write({args:[A,(0,i.fi)(j.toString()),m],value:(0,i.fi)("0.003")})},children:"鎖倉 TCP"})})]})]})})})})})}var m=a(85091);function PricingTables(){var e,s;let[a,r]=(0,t.useState)(!1),u=(0,n.xx)(),{address:x,isConnecting:h,isDisconnected:f}=(0,n.mA)(),[b,v]=(0,t.useState)(0),[p,w]=(0,t.useState)(0),[N,j]=(0,t.useState)(0),[g,k]=(0,t.useState)(0),[y,S]=(0,t.useState)(!1),[C,F]=(0,t.useState)(!1),[L,A]=(0,t.useState)(0);(0,n.Dm)({contracts:[{address:d.wA.address[u],abi:d.wA.abi,functionName:"getUnlockAmount",args:[x]},{address:d.wA.address[u],abi:d.wA.abi,functionName:"getWaitHarvest",args:[x]},{address:d.wA.address[u],abi:d.wA.abi,functionName:"getUserInfo",args:[x]}],watch:!0,onSuccess:e=>{console.log("useContractReads",e),v(Number((0,i.dF)(e[2].result[2])).toFixed(1)),w(Number((0,i.dF)(e[0].result)).toFixed(1)),j(Number((0,i.dF)(e[1].result)).toFixed(1)),k(Number((0,i.dF)(e[2].result[3])).toFixed(1))}}),(0,n.KQ)({address:x,token:d.lS.address[u],watch:!0,onSuccess(e){A(Number(e.formatted).toFixed(1))}});let P=(0,n.GG)({address:d.wA.address[u],abi:d.wA.abi,functionName:"harvest",onError(e){S(!1),c.default.error(e.details)}}),T=(0,n.GG)({address:d.wA.address[u],abi:d.wA.abi,functionName:"relock",onError(e){F(!1),c.default.error(e.details)}});return(0,n.BX)({hash:null===(e=P.data)||void 0===e?void 0:e.hash,onSuccess(e){e.blockNumber&&(c.default.success("領取成功"),S(!1))}}),(0,n.BX)({hash:null===(s=T.data)||void 0===s?void 0:s.hash,onSuccess(e){e.blockNumber&&(c.default.success("復投成功"),F(!1))}}),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"max-w-sm mx-auto grid gap-8 lg:grid-cols-2 items-start lg:max-w-none pt-4",children:[(0,l.jsxs)("div",{className:"relative flex flex-col h-full px-6 py-5 bg-white shadow-lg","data-aos":"fade-up","data-aos-delay":"100",children:[(0,l.jsxs)("div",{className:"h4 pb-4",children:[(0,l.jsx)("span",{className:"border-l-4 border-blue-800  pl-2",children:"持倉"}),"信息"]}),(0,l.jsxs)("div",{className:"mb-4 pb-4 flex flex-row space-x-3",children:[(0,l.jsxs)("div",{className:"w-1/2 border-r-3 border-slate-200 text-left",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-800 mb-1 w-full",children:"持倉金額"}),(0,l.jsxs)("div",{className:" items-baseline mb-3  w-full  space-x-1",children:[(0,l.jsx)("span",{className:"h2 leading-7 font-playfair-display text-slate-800",children:b}),(0,l.jsx)("span",{className:" text-slate-400 font-bold",children:"TCP"})]}),(0,l.jsxs)("div",{className:"rounded  w-full",children:[(0,l.jsx)("button",{className:"btn-sm text-white bg-blue-600 hover:bg-blue-700 group",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(!0)},children:"添加持倉"}),(0,l.jsx)(m.Z,{id:"PositionAdd",ariaLabel:"1232",show:a,handleClose:()=>{r(!1)},children:(0,l.jsx)(PositionAdd,{close:()=>{r(!1)}})})]})]}),(0,l.jsxs)("div",{className:"w-1/2 text-right",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-800 mb-1 w-full",children:"已釋放"}),(0,l.jsxs)("div",{className:" items-baseline mb-3  w-full  space-x-1",children:[(0,l.jsx)("span",{className:"h2 leading-7 font-playfair-display text-slate-800",children:p}),(0,l.jsx)("span",{className:" text-slate-400  font-bold",children:"TCP"})]})]})]}),(0,l.jsx)("div",{className:"mb-4 pb-4 flex flex-row space-x-3",children:(0,l.jsxs)("div",{className:"w-1/2 text-left",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-800 mb-1 w-full",children:"餘額"}),(0,l.jsxs)("div",{className:" items-baseline mb-3  w-full  space-x-1",children:[(0,l.jsx)("span",{className:"h2 leading-7 font-playfair-display text-slate-800",children:L}),(0,l.jsx)("span",{className:" text-slate-400  font-bold",children:"TCP"})]})]})})]}),(0,l.jsxs)("div",{className:"relative flex flex-col h-full px-6 py-5 bg-white shadow-lg","data-aos":"fade-up","data-aos-delay":"100",children:[(0,l.jsxs)("div",{className:"h4 pb-4",children:[(0,l.jsx)("span",{className:"border-l-4 border-blue-800  pl-2",children:"複息"}),"信息"]}),(0,l.jsxs)("div",{className:"mb-4 pb-4 flex flex-row space-x-3",children:[(0,l.jsxs)("div",{className:"w-1/2 border-r-3 border-slate-200 text-left",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-800 mb-1 w-full",children:"待領取"}),(0,l.jsxs)("div",{className:" items-baseline mb-3  w-full  space-x-1",children:[(0,l.jsx)("span",{className:"h2 leading-7 font-playfair-display text-slate-800",children:N}),(0,l.jsx)("span",{className:" text-slate-400  font-bold",children:"TCP"})]}),(0,l.jsxs)("div",{className:"rounded  w-full space-x-1 flex",children:[(0,l.jsx)(o.Z,{isLoading:y,disabled:y,onClick:()=>{S(!0),P.write({value:(0,i.fi)("0.003")})},children:"領取"}),(0,l.jsx)(o.Z,{isLoading:C,disabled:C,onClick:()=>{F(!0),T.write({value:(0,i.fi)("0.003")})},children:"復投"})]})]}),(0,l.jsxs)("div",{className:"w-1/2  border-slate-200 text-right",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-slate-800 mb-1 w-full",children:"已領取"}),(0,l.jsxs)("div",{className:" items-baseline mb-3  w-full space-x-1",children:[(0,l.jsx)("span",{className:"h2 leading-7 font-playfair-display text-slate-800",children:g}),(0,l.jsx)("span",{className:"font-bold text-slate-400",children:"TCP"})]})]})]})]})]})})}},8152:function(e,s,a){a.d(s,{Z:function(){return Button}});var l=a(57437);function Button(e){let{children:s,isLoading:a=!1,disabled:t=!1,className:n="w-full btn-sm  mt-4",onClick:i}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("button",{disabled:t,className:"".concat(t?"text-white bg-slate-600 hover:bg-slate-700":"text-white bg-blue-600 hover:bg-blue-700"," ").concat(n),onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"".concat(a?"flex":"hidden"," w-6 h-6 animate-spin"),children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),s]})})}},85091:function(e,s,a){a.d(s,{Z:function(){return Modal}});var l=a(57437),t=a(2265),n=a(27856);function Modal(e){let{children:s,id:a,ariaLabel:i,show:r,handleClose:d}=e,o=(0,t.useRef)(null);return(0,t.useEffect)(()=>{let clickHandler=e=>{var s;let{target:a}=e;!r||(null===(s=o.current)||void 0===s?void 0:s.contains(a))||d()};return document.addEventListener("click",clickHandler),()=>document.removeEventListener("click",clickHandler)},[r,d,o]),(0,t.useEffect)(()=>{let keyHandler=e=>{let{keyCode:s}=e;27===s&&d()};return document.addEventListener("keydown",keyHandler),()=>document.removeEventListener("keydown",keyHandler)},[d]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.u,{show:r,enter:"transition ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition ease-out duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",className:"fixed inset-0 z-50 bg-black bg-opacity-75 transition-opacity","aria-hidden":"true"}),(0,l.jsx)(n.u,{show:r,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ttransition ease-out duration-200",leaveFrom:"oopacity-100 scale-100",leaveTo:"opacity-0 scale-95",id:a,className:"fixed inset-0 z-50 overflow-hidden flex items-center justify-center transform px-4 sm:px-6",role:"dialog","aria-modal":"true","aria-labelledby":i,children:(0,l.jsx)("div",{className:"bg-white overflow-auto  max-h-full",ref:o,children:s})})]})}}}]);